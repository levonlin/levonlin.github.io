
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>【译】发送表单数据 | 荒村</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    
    <meta name="description" content="系列文章说明
原文


多数时候，HTML表单的目的只是为了把数据发给服务器，之后服务器再处理这些数据并发送响应给用户。虽然看起来挺简单的，但我们还是得注意一些事情以确保传送的数据不会破坏服务器、或者给你的用户制造麻烦。
数据会到哪里去关于客户端/服务器架构整个web都是基于一种基本的客户端/服务器">
    
    
    
    
    <link rel="alternative" href="/atom.xml" title="荒村" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/Tinny.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/Tinny.jpg">
    

  
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    
  

    <link rel="stylesheet" href="/css/style.css">
    <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?d182ed77fc48758bf45a33835ee35745";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

      <script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v1/st.js','_st');

  _st('install','Rr85pzY1M1tZC1UWGo8f');
</script>
</head>

  <body>
    <header>
      <div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="荒村">荒村</a></h1>
				<h2 class="blog-motto">新草掩旧路，野鬼吟残书。</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
                    <ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/about">关于我</a></li>
					
					<li>
					
						<form class="search" action="/search/index.html" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="st-search-inpu" maxlength="20" placeholder="Search" />
						</form>
					
					</li>
                <!--<li><div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div></li>-->

				</ul>
			</nav>	
</div>
    </header>
    <div id="container" class="clearfix">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/09/24/【译】发送表单数据/" title="【译】发送表单数据" itemprop="url">【译】发送表单数据</a>
  </h1>
  <p class="article-time">
    <time datetime="2016-09-24T11:37:28.000Z" itemprop="datePublished">2016年 9月 24日</time>
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title"></strong>
		<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#数据会到哪里去"><span class="toc-number">1.</span> <span class="toc-text">数据会到哪里去</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#关于客户端-服务器架构"><span class="toc-number">1.1.</span> <span class="toc-text">关于客户端/服务器架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#客户端：定义如何发送数据"><span class="toc-number">1.2.</span> <span class="toc-text">客户端：定义如何发送数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#action特性"><span class="toc-number">1.2.1.</span> <span class="toc-text">action特性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#method特性"><span class="toc-number">1.2.2.</span> <span class="toc-text">method特性</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#GET方法"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">GET方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#POST方法"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">POST方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#服务器端：处理数据"><span class="toc-number">1.3.</span> <span class="toc-text">服务器端：处理数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#示例：原生PHP"><span class="toc-number">1.3.1.</span> <span class="toc-text">示例：原生PHP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#示例：原生Python"><span class="toc-number">1.3.2.</span> <span class="toc-text">示例：原生Python</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#其它语言和框架"><span class="toc-number">1.3.3.</span> <span class="toc-text">其它语言和框架</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#特殊案例：发送文件"><span class="toc-number">2.</span> <span class="toc-text">特殊案例：发送文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#enctype特性"><span class="toc-number">2.1.</span> <span class="toc-text">enctype特性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安全相关"><span class="toc-number">3.</span> <span class="toc-text">安全相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#常见的安全问题"><span class="toc-number">3.1.</span> <span class="toc-text">常见的安全问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#XSS和CSRF"><span class="toc-number">3.1.1.</span> <span class="toc-text">XSS和CSRF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL注入"><span class="toc-number">3.1.2.</span> <span class="toc-text">SQL注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP头部注入和邮件注入"><span class="toc-number">3.1.3.</span> <span class="toc-text">HTTP头部注入和邮件注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#偏执些：永远别信任你的用户"><span class="toc-number">3.2.</span> <span class="toc-text">偏执些：永远别信任你的用户</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#结论"><span class="toc-number">4.</span> <span class="toc-text">结论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参见"><span class="toc-number">5.</span> <span class="toc-text">参见</span></a></li></ol>
		</div>
		
		<blockquote>
<ul>
<li><a href="http://levonlin.info/2016/04/28/%E3%80%90%E8%AF%91%E3%80%91HTML%E8%A1%A8%E5%8D%95%E6%8C%87%E5%8D%97-%E7%AC%AC%E4%B8%80%E4%B8%AAHTML%E8%A1%A8%E5%8D%95/">系列文章说明</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Forms/Sending_and_retrieving_form_data#Where_does_the_data_go" target="_blank" rel="external">原文</a></li>
</ul>
</blockquote>
<p>多数时候，<a href="https://developer.mozilla.org/en-US/docs/HTML/Forms" target="_blank" rel="external">HTML表单</a>的目的只是为了把数据发给服务器，之后服务器再处理这些数据并发送响应给用户。虽然看起来挺简单的，但我们还是得注意一些事情以确保传送的数据不会破坏服务器、或者给你的用户制造麻烦。</p>
<h2 id="数据会到哪里去"><a href="#数据会到哪里去" class="headerlink" title="数据会到哪里去"></a>数据会到哪里去</h2><h3 id="关于客户端-服务器架构"><a href="#关于客户端-服务器架构" class="headerlink" title="关于客户端/服务器架构"></a>关于客户端/服务器架构</h3><p>整个web都是基于一种基本的客户端/服务器架构，该架构可以归纳如下：</p>
<p>一个客户端（通常是Web浏览器）使用<a href="https://developer.mozilla.org/en-US/docs/HTTP" target="_blank" rel="external">HTTP协议</a>发送一个请求给服务器（通常是web服务器程序，譬如<a href="http://httpd.apache.org/" target="_blank" rel="external">Apache</a>, <a href="http://nginx.com/" target="_blank" rel="external">Nginx</a>, <a href="http://www.iis.net/" target="_blank" rel="external">IIS</a>, <a href="http://tomcat.apache.org/" target="_blank" rel="external">Tomcat</a>等等），而服务器则以相同的协议响应这个请求。</p>
<p><img src="https://mdn.mozillademos.org/files/4291/client-server.png" alt=""></p>
<p>在客户端，HTML表单只是提供一种比较方便且用户友好的方式，用来配置发送给服务器的HTTP请求。这样用户就可以自己提供能被HTTP请求传送的信息。</p>
<h3 id="客户端：定义如何发送数据"><a href="#客户端：定义如何发送数据" class="headerlink" title="客户端：定义如何发送数据"></a>客户端：定义如何发送数据</h3><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form" target="_blank" rel="external"><code>&lt;form&gt;</code></a>元素能够定义其数据如何被发送，它所有的特性都是为了在用户点击发送按钮时，让你配置要发送的请求。其中最重要的两个特性是<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form#attr-action" target="_blank" rel="external">action</a>和<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form#attr-method" target="_blank" rel="external">method</a>。</p>
<h4 id="action特性"><a href="#action特性" class="headerlink" title="action特性"></a>action特性</h4><p>该特性定义了数据会被发往何处，它的值必须是个合法的URL。若该特性未指定，则数据会发送到包含该表单的页面所在的URL。</p>
<p><strong>示例</strong><br>在下面的例子中，数据会发送至<a href="http://foo.com：" target="_blank" rel="external">http://foo.com：</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://foo.com"</span>&gt;</span></div></pre></td></tr></table></figure>
<p>这里，数据会被发送到表单页所在的服务器，但到达的却是服务器上不同的URL：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/somewhere_else"</span>&gt;</span></div></pre></td></tr></table></figure>
<p>如下，当不指定任何特性时，表单数据会给发送到包含该表单的的页面：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></div></pre></td></tr></table></figure>
<p>许多老旧的页面会使用下面的符号来表明，数据得被发送到包含该表单的的页面；这在当时是必须的，因为直到HTML5之前，action特性都是必填的。但现在就不再需要了。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"#"</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意：</strong>可以指定一个使用HTTPS（安全的HTTP）协议的URL，此时数据会随请求的其他部分一起加密，即使表单本身位于一个通过HTTP访问的不安全页面。此外，若表单位于一个安全的页面，而你却给action特性指定了一个不安全的HTTP URL，则所有的浏览器会在每次用户要发送数据时给他们一个安全警告，因为此时这些数据将不被加密。</p>
</blockquote>
<h4 id="method特性"><a href="#method特性" class="headerlink" title="method特性"></a>method特性</h4><p>该特性定义了数据如何被发送。HTTP协议提供了几种方式来执行一个请求；HTML表单数据可以通过其中至少方式来发送：GET和POST。</p>
<p>要理解这两种方式的不同，我们得回过头来来看下HTTP是如何工作的。当你想取得Web上的某个资源时，浏览器会发送一个请求给指定的URL。一个HTTP请求含有两个部分：包含和浏览器功能有关的一系列全局字段的请求头，以及包含要给服务器处理的信息的请求体。</p>
<h5 id="GET方法"><a href="#GET方法" class="headerlink" title="GET方法"></a>GET方法</h5><p>浏览器使用GET方法来请求服务器发回指定的资源：“嘿服务器，我想获得这个资源”。这种情况下，浏览器只会发送一个空的请求体，而正因如此，若浏览器使用该方式，那么发给服务器的数据会给追加到URL后面。</p>
<p><strong>示例</strong><br>考虑如下表单：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://foo.com"</span> <span class="attr">method</span>=<span class="string">"get"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"say"</span> <span class="attr">value</span>=<span class="string">"Hi"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"to"</span> <span class="attr">value</span>=<span class="string">"Mom"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span>Send my greetings<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div></pre></td></tr></table></figure>
<p>使用GET方法时，HTTP请求看起来就这样：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">GET</span> <span class="string">/?say=Hi&amp;to=Mom</span> HTTP/1.1</div><div class="line"><span class="attribute">Host</span>: foo.com</div></pre></td></tr></table></figure>
<h5 id="POST方法"><a href="#POST方法" class="headerlink" title="POST方法"></a>POST方法</h5><p>POST方法则稍有不同，浏览器发送这个方法给服务器，用以请求一个和HTTP请求体里数据有关的响应：“嘿服务器，看看这些数据然后给我发回一个适当的结果”。若表单使用该方法发送，则数据会给追加到HTTP请求体里。</p>
<p><strong>示例</strong><br>考虑如下表单（和上面那个一样）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://foo.com"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"say"</span> <span class="attr">value</span>=<span class="string">"Hi"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"to"</span> <span class="attr">value</span>=<span class="string">"Mom"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span>Send my greetings<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div></pre></td></tr></table></figure>
<p>使用POST方法时，HTTP请求看起来就这样：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">POST</span> <span class="string">/</span> HTTP/1.1</div><div class="line"><span class="attribute">Host</span>: foo.com</div><div class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</div><div class="line"><span class="attribute">Content-Length</span>: 13</div><div class="line"></div><div class="line"><span class="applescript"><span class="built_in">say</span>=Hi&amp;<span class="keyword">to</span>=Mom</span></div></pre></td></tr></table></figure>
<p><code>Content-length</code>头部字段指示了请求体的大小，而<code>Content-Type</code>字段则标识了发往服务器的资源类型。我们将在稍后讨论下这些请求头。</p>
<p>当然，HTTP请求是不会展示给用户看的（若你想看到它们，还得使用诸如火狐的<a href="https://developer.mozilla.org/en-US/docs/Tools/Web_Console" target="_blank" rel="external">Web Console</a>或者<a href="https://developers.google.com/chrome-developer-tools/" target="_blank" rel="external">chrome Developer Tools</a>等工具），唯一展示给用户的，只有访问的URL。所以使用GET请求时，用户将会在他们的地址栏看到数据，而使用POST请求则看不到。这点至关重要，原因如下：</p>
<ol>
<li>若你要发送密码（或者任何敏感数据），那千万别用GET方法，否则该数据会不安全地展示在地址栏上。</li>
<li>若你想要发送大量数据，最好用POST方法，因为一些浏览器会限制URL的大小。此外，许多服务器也会限制接收的URL长度。</li>
</ol>
<h3 id="服务器端：处理数据"><a href="#服务器端：处理数据" class="headerlink" title="服务器端：处理数据"></a>服务器端：处理数据</h3><p>不论你选择哪种HTTP方法，服务器只会接收到一个字符串并将其解析，再以键/值对列表的形式获取数据。而如何访问这个列表，取决于你基于何种开发平台、以及用了何种框架。你使用的技术也会决定如何处理重复的键名，通常某个键名最后接收到的值是优先被选取的。</p>
<h4 id="示例：原生PHP"><a href="#示例：原生PHP" class="headerlink" title="示例：原生PHP"></a>示例：原生PHP</h4><p>PHP提供了几个全局对象来处理数据。假设你使用POST方法，下面的示例会直接提取你的数据并展示给用户。当然，要如何处理数据取决于你，你可以展示它、将其存进数据库、用邮件发送它、或者其他任何方式。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">  <span class="comment">// 全局变量$_POST让你能够访问用POST方法发送的数据</span></div><div class="line">  <span class="comment">// 要访问用GET方法发送的数据，可以使用$_GET</span></div><div class="line">  $say = htmlspecialchars($_POST[<span class="string">'say'</span>]);</div><div class="line">  $to  = htmlspecialchars($_POST[<span class="string">'to'</span>]);</div><div class="line"></div><div class="line">  <span class="keyword">echo</span>  $say, <span class="string">' '</span>, $to;</div></pre></td></tr></table></figure>
<p>这个示例会用我们发送的数据生成一个页面。考虑我们前面用的表单示例数据，输出结果会是：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Hi Mom</div></pre></td></tr></table></figure>
<h4 id="示例：原生Python"><a href="#示例：原生Python" class="headerlink" title="示例：原生Python"></a>示例：原生Python</h4><p>下面的示例使用Python来做相同的事—将给定的数据展示到web页面上。其中使用了<a href="http://docs.python.org/3/library/cgi.html" target="_blank" rel="external">CGI Python package </a>来处理表单数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="keyword">import</span> html</div><div class="line"><span class="keyword">import</span> cgi</div><div class="line"><span class="keyword">import</span> cgitb; cgitb.enable()     <span class="comment"># 用于处理错误</span></div><div class="line"></div><div class="line">print(<span class="string">"Content-Type: text/html"</span>) <span class="comment"># 请求头字段，标识后面的内容是HTML</span></div><div class="line">print()                          <span class="comment"># 空行，表示请求头的结束</span></div><div class="line"></div><div class="line">form = cgi.FieldStorage()</div><div class="line">say  = html.escape(form[<span class="string">"say"</span>].value);</div><div class="line">to   = html.escape(form[<span class="string">"to"</span>].value);</div><div class="line"></div><div class="line">print(say, <span class="string">" "</span>, to)</div></pre></td></tr></table></figure>
<p>结果和之前用PHP处理是一样的：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Hi Mom</div></pre></td></tr></table></figure>
<h4 id="其它语言和框架"><a href="#其它语言和框架" class="headerlink" title="其它语言和框架"></a>其它语言和框架</h4><p>还有许多其他的服务端技术可以用来处理表单，比如Perl, Java, <a href="http://www.microsoft.com/net" target="_blank" rel="external">.Net</a>, Ruby等等，选择你最喜欢的一种就好。我们很少直接使用这些技术，因为这么做得需要很多技巧来填坑；通常我们会在众多好用的框架中选择一种，这样会让表单的处理更容易些，比如：</p>
<ul>
<li><a href="http://symfony.com/" target="_blank" rel="external">Symfony</a> for PHP</li>
<li><a href="https://www.djangoproject.com/" target="_blank" rel="external">Django</a> for Python</li>
<li><a href="http://rubyonrails.org/" target="_blank" rel="external">Ruby</a> On Rails for Ruby</li>
<li><a href="http://grails.org/" target="_blank" rel="external">Grails</a> for Java</li>
</ul>
<p>值得注意的是，就算用了这些框架，处理表单是不一定就会变得轻松。但至少这样用起来会更好些，还能节省你不少时间。</p>
<h2 id="特殊案例：发送文件"><a href="#特殊案例：发送文件" class="headerlink" title="特殊案例：发送文件"></a>特殊案例：发送文件</h2><p>文件是HTML表单中一个特殊的例子，其他数据都是文本数据，而文件则一般是、或者被认为是二进制数据。由于HTTP是个文本协议，所以对处理二进制数据得有特别的要求。</p>
<h3 id="enctype特性"><a href="#enctype特性" class="headerlink" title="enctype特性"></a>enctype特性</h3><p>该特性能让你指定HTTP请求头中的<code>Content-Type</code>字段值，这个字段的重要性在于，它能告诉服务器要发送的数据类型。其默认值是<code>application/x-www-form-urlencoded</code>，对应的解释是：“这份表单数据已被编码为URL格式”。</p>
<p>而当你想发送文件时，得先做两件事：</p>
<ul>
<li>将method特性设置为<code>POST</code>，因为使用表单时，文件内容是不能被放到URL参数里的</li>
<li>将<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form#attr-enctype" target="_blank" rel="external">enctype</a>特性的值设为<code>multipart/form-data</code>，这样数据就会被分割为多个部分，每个文件都会追加上和他们一起发送的表单有关的文本。</li>
</ul>
<p>示例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"myFile"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span>Send the file<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意：</strong>某些浏览器支持<code>&lt;input&gt;</code>元素的<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-multiple" target="_blank" rel="external">multiple</a>特性，以便让一个input元素能发送多个文件。至于服务器会如何处理这些文件，就得取决于它用来什么技术了。如前所述，使用框架能让你的活的轻松些~</p>
<p><strong>警告：</strong>为防止滥用，许多服务器会对文件和HTTP请求设置大小限制。所以，最好在发送文件之前和服务器管理员核实一下这个限制。</p>
</blockquote>
<h2 id="安全相关"><a href="#安全相关" class="headerlink" title="安全相关"></a>安全相关</h2><p>每次要发数据给服务器前，你都得考虑下安全问题。HTML表单是针对服务器的首要攻击载体之一，但该危害的来源并非HTML表单本身，而在于服务器如何处理数据。</p>
<h3 id="常见的安全问题"><a href="#常见的安全问题" class="headerlink" title="常见的安全问题"></a>常见的安全问题</h3><p>著名的安全问题有很多，如何划分取决于你在做什么：</p>
<h4 id="XSS和CSRF"><a href="#XSS和CSRF" class="headerlink" title="XSS和CSRF"></a>XSS和CSRF</h4><p>跨站脚本攻击（XSS）和跨站请求伪造（CSRF）是最常见的攻击类型，它们会在你展示由用户发给用户的数据时发生。</p>
<p>XSS让攻击者能再其他用户访问的Web页面上注入客户端脚本。攻击者会利用跨站脚本的脆弱性来绕过访问控制策略，譬如<a href="https://developer.mozilla.org/en-US/docs/JavaScript/Same_origin_policy_for_JavaScript" target="_blank" rel="external">同源策略</a>。这种攻击可以取得从小麻烦到严重安全危机不等的危害效果。</p>
<p>CSRF很像XSS，因为它们都以相同的方式开始—注入客户端脚本到Web页面，但它们的攻击目标却不同。CSRF攻击者会试着升级权限以成为一个高权限的用户（比如网站管理员），然后执行本不能够执行的动作（如把数据发送给不受信任的用户）。</p>
<p>XSS攻击利用了用户对网站的信任，而CSRF攻击则利用了网站对其用户的信任。</p>
<p>要防止此类攻击，就得时常校验用户发送给服务器的数据；同时（如果需要展示）也尽量别展示用户提供的HTML内容，而应该处理用户提供的数据，以避免将其原封不动地显示出来。目前几乎所有市面上的的框架，至少都会实现一个过滤器，用以移除用户提交数据中<code>&lt;script&gt;</code>, <code>&lt;iframe&gt;</code>, <code>&lt;object&gt;</code>等标签，这样有助于减轻风险，但并不意味着会根除它。</p>
<h4 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h4><p>SQL注入是一种对目标网站的数据库执行动作的攻击方式。通常攻击者会发送一段SQL请求，并希望服务器能执行它（多数发生在应用服务器想存储数据之时）。这实际上已成为<a href="https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project" target="_blank" rel="external">针对web站点的主要攻击载体之一</a>。</p>
<p>该攻击的危害是很严重的，小到数据丢失、大到被攻击者通过权限升级访问整个网站架构。这确实是非常重大的威胁，所以你不应该存储那些用户提交而没经过特殊处理（例如，在PHP/MySQL架构下经过<a href="http://www.php.net/manual/en/function.mysql-real-escape-string.php" target="_blank" rel="external">mysql_real_escape_string()</a>处理）的数据。</p>
<h4 id="HTTP头部注入和邮件注入"><a href="#HTTP头部注入和邮件注入" class="headerlink" title="HTTP头部注入和邮件注入"></a>HTTP头部注入和邮件注入</h4><p>这种攻击会在你的应用使用用户在表单上输入的数据来构造HTTP头、或者email时发生。该攻击虽然不会危害你的服务器或者影响你的用户，但却会给更深处的问题大开方便之门，比如会话劫持、钓鱼攻击。</p>
<p>所有这些攻击往往都是悄无声息地发生的，而且会把你的服务器弄成<a href="http://en.wikipedia.org/wiki/Zombie_(computer_science" target="_blank" rel="external">肉鸡</a>)。</p>
<h3 id="偏执些：永远别信任你的用户"><a href="#偏执些：永远别信任你的用户" class="headerlink" title="偏执些：永远别信任你的用户"></a>偏执些：永远别信任你的用户</h3><p>所以，要如何对抗这些威胁呢？这一点已超出本指南的主题范围了，但有几条规则时需要我们牢记的。最重要的一条就是：永远别信任你的用户，包括你自己；即使是受信任的用户也会有被劫持可能。</p>
<p>所有的到达你服务器的数据都必须被校验并处理，而且要一直保持，不能有例外。</p>
<ul>
<li>过滤潜在的危险字符。要关注的哪些特定字符，取决于使用数据的上下文、也取决于你使用的服务器平台，而所有的服务端语言都会提供相应的功能。</li>
<li>限制传入的数据量，只允许有必要的。</li>
<li>把上传的文件放沙盒里（将它们存储到放到一个不同的服务器上，并且要访问到它们只有通过一个不同的子域名、或一个完全不同的域名才行）。</li>
</ul>
<p>若你能遵循这三条规则，就应该能避免绝大多数问题，但一个更好的办法是让一个有资格的第三方来做安全审查，别以为你能看透所有潜在的问题。</p>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>如你所见，发送表单数据时很简单的，但保障一个应用的安全就需要很多技术了。前端开发者不是那种去定义一个数据安全模型的角色，虽然可能得执行<a href="">客户端数据校验</a>，但是服务器也不能信任这些校验，因为它并不能确切知道客户端上到底发生过什么。</p>
<h2 id="参见"><a href="#参见" class="headerlink" title="参见"></a>参见</h2><p>若你想学习更多关于wep应用安全防护的知识，可以深入了解下面这些资源：</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Main_Page" target="_blank" rel="external">The Open Web Application Security Project (OWASP)</a></li>
<li><a href="http://shiflett.org/" target="_blank" rel="external">Chris Shiflett’s blog about PHP Security</a></li>
</ul>
  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/前端/">前端</a><a href="/tags/html/">html</a><a href="/tags/翻译/">翻译</a><a href="/tags/web/">web</a>
  </div>


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/前端/">前端</a>
</div>



<div class="article-share" id="share">

  <div data-url="http://levonlin.info/2016/09/24/【译】发送表单数据/" data-title="【译】发送表单数据 | 荒村" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2016/12/31/【译】表单数据校验/" title="【译】表单数据校验">
  <strong>新一篇:</strong><br/>
  <span>
  【译】表单数据校验</span>
</a>
</div>


<div class="next">
<a href="/2016/09/11/DOM元素的属性（property）和特性（attribute）/"  title="DOM元素的属性（property）和特性（attribute）">
 <strong>旧一篇:</strong><br/> 
 <span>DOM元素的属性（property）和特性（attribute）
</span>
</a>
</div>

</nav>

	
<section class="comment">
	
	<div class="ds-thread" data-title="【译】发送表单数据" data-thread-key="【译】发送表单数据" data-author-key="null" data-url="http://levonlin.info/post/【译】发送表单数据"></div>
	
</section>


</div>  
    </div>
    <footer><div id="footer" >
	<div class="copyright">
		<span>Powered by <a href="https://github.com/hexojs/hexo">Hexo</a> and theme by 
		<a href="https://github.com/levonlin/Tinnypp">Tinnypp</a>.</span>
		
			<span>© Levon</span>
		
	<div>
</div></footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  //back to top
  function backToTop(){
    var buttonHTML = $("<a href=\"#top\" id=\"back-top\">" + "<span>Back to Top</span></a>");
    buttonHTML.appendTo($("body"));
    var buttonToTop = $("#back-top");
    // hide #back-top first
    buttonToTop.hide();

    // fade in #back-top
    $(function() {
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                buttonToTop.fadeIn();
            } else {
                buttonToTop.fadeOut();
            }
        });
        // scroll body to 0px on click
        buttonToTop.click(function() {
            $('body,html').animate({
                scrollTop: 0
            }, 800);
            return false;
        });
    });
  }
  backToTop();

  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      ta = $('#toc.toc-aside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
        
    }
  });

  var show = true;
  c.click(function(){
    if(show == true){
        a.addClass('fadeOut').css('display', 'none');
        ta.css('display', 'block').addClass('fadeIn');
        m.addClass('moveMain');  
    }else{
        a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');     
        ta.css('display', 'none'); 
        m.removeClass('moveMain');
        $('#toc.toc-aside').css('display', 'none');
    }
    show = !show;
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{

    $(window).scroll(function(){
      ta.css("top",Math.max(140,240-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"levonlingithubio"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '/js/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>

<script type="text/javascript">
  function footerPosition() {
    var contentHeight = document.documentElement.scrollHeight,
        winHeight = window.innerHeight;
    if(contentHeight <= winHeight) {
      $('footer').addClass('fixed-bottom');
    } else {
      $('footer').removeClass('fixed-bottom');
    }
  }
  footerPosition();
  $(window).resize(footerPosition);
</script>


  </body>
</html>
